/*!
 * iButton jQuery Plug-in
 *
 * Copyright 2011 Giva, Inc. (http://www.givainc.com/labs/) 
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * 	http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Date: 2011-07-26
 * Rev:  1.0.03
 *
 *
 * MoonCake v1.0 - iButton Plugin JS
 *
 * This file is part of MoonCake, an Admin template build for sale at ThemeForest.
 * For questions, suggestions or support request, please mail me at maimairel@yahoo.com
 *
 * Development Started:
 * July 28, 2012
 *
 * This file is a modification of iButton jQuery Plug-in from Giva-labs (http://www.givainc.com/labs/ibutton_jquery_plugin.htm)
 *
 */

;(function(c){c.iButton={version:"1.0.03",setDefaults:function(g){c.extend(y,g)}};c.fn.iButton=function(g){var a="string"==typeof arguments[0]&&arguments[0],i=a&&Array.prototype.slice.call(arguments,1)||arguments,b=0==this.length?null:c.data(this[0],"iButton");if(b&&a&&this.length){if("object"==a.toLowerCase())return b;if(b[a]){var f;this.each(function(g){var d=c.data(this,"iButton")[a].apply(b,i);if(0==g&&d)if(d.jquery)f=c([]).add(d);else return f=d,!1;else d&&d.jquery&&(f=f.add(d))});return f||this}return this}return this.each(function(){new B(this,
g)})};c(function(){c('[data-provide="ibutton"]').each(function(){var g=c(this);g.iButton(g.data())})});var C=0;c.browser.iphone=-1<navigator.userAgent.toLowerCase().indexOf("iphone");var B=function(g,a){var i=this,b=c(g),f=++C,m=!1,d,u,v,w=!1,n=null,z=null,p=null,A=null,a=c.extend({},y,a,b.data());if(b.is(":checkbox, :radio")){if(c.data(b[0],"iButton"))return}else return b.find(":checkbox, :radio").iButton(a);c.data(b[0],"iButton",i);b.parent().is("label")&&b.parent().bind("click.iButton",function(a){a.preventDefault()});
this.toggle=function(a){b.attr("checked",0<arguments.length?a:!b[0].checked).trigger("change")};this.disable=function(e){var d=0<arguments.length?e:!m;m=d;b.attr("disabled",d);h[d?"addClass":"removeClass"](a.classDisabled);c.isFunction(a.disable)&&a.disable.apply(i,[m,b,a])};this.repaint=function(){q()};this.destroy=function(){c([b[0],h[0]]).unbind(".iButton");b.parent().is("label")&&b.parent().unbind(".iButton");c(document).unbind(".iButton_"+f);h.after(b).remove();c.data(b[0],"iButton",null);c.isFunction(a.destroy)&&
a.destroy.apply(i,[b,a])};b.wrap('<div class="'+c.trim(a.classContainer+" "+a.className)+'" />').after('<div class="'+a.classHandle+'"><div class="'+a.classHandleInner+'" /></div><div class="'+a.classLabelOff+'"><span><label>'+a.labelOff+'</label></span></div><div class="'+a.classLabelOn+'"><span><label>'+a.labelOn+"</label></span></div>");var h=b.parent(),k=b.siblings("."+a.classHandle),r=b.siblings("."+a.classLabelOff),s=r.children("span"),l=b.siblings("."+a.classLabelOn),t=l.children("span");d=
t.outerWidth();u=s.outerWidth();v=Math.min(d,u);k.css("width",v);d+=u;h.css("width",d+Math.max(parseInt(r.css("border-left-width"),10)+parseInt(r.css("border-right-width"),10),parseInt(l.css("border-left-width"),10)+parseInt(l.css("border-right-width"),10)));r.css("width",d);var j=d-v,q=function(e){var c=b[0].checked?j:0;(e=0<arguments.length?arguments[0]:!0)&&a.enableFx?(k.stop().animate({left:c},a.duration,a.easing),l.stop().animate({width:c},a.duration,a.easing),t.stop().animate({marginLeft:c-
j},a.duration,a.easing),s.stop().animate({marginRight:-c},a.duration,a.easing)):(k.css("left",c),l.css("width",c),t.css("marginLeft",c-j),s.css("marginRight",-c))};q(!1);var x=function(a){return a.pageX||(a.originalEvent.changedTouches?a.originalEvent.changedTouches[0].pageX:0)};h.bind("mousedown.iButton touchstart.iButton",function(e){if(!c(e.target).is(":checkbox, :radio")&&!(m||!a.allowRadioUncheck&&b.is(":radio:checked")))return e.preventDefault(),n=k,z=x(e),p=z-(parseInt(k.css("left"),10)||0),
A=(new Date).getTime(),!1});a.enableDrag&&c(document).bind("mousemove.iButton_"+f+" touchmove.iButton_"+f,function(b){if(n==k)return b.preventDefault(),b=x(b),b!=p&&(w=!0,h.addClass(a.classHandleActive)),b=Math.min(1,Math.max(0,(b-p)/j)),k.css("left",b*j),l.css("width",b*j),s.css("marginRight",-b*j),t.css("marginLeft",-(1-b)*j),!1});c(document).bind("mouseup.iButton_"+f+" touchend.iButton_"+f,function(e){if(n!=k)return!1;e.preventDefault();var d=!0;!w||(new Date).getTime()-A<a.clickOffset?(e=b[0].checked,
b.attr("checked",!e),c.isFunction(a.click)&&a.click.apply(i,[!e,b,a])):(e=0.5<=(x(e)-p)/j,b[0].checked==e&&(d=!1),b.attr("checked",e));h.removeClass(a.classHandleActive);w=n=null;d?b.trigger("change"):q();return!1});b.bind("change.iButton",function(){q();if(b.is(":radio")){var d=b[0];c(d.form?d.form[d.name]:":radio[name="+d.name+"]").filter(":not(:checked)").iButton("repaint")}c.isFunction(a.change)&&a.change.apply(i,[b,a])}).bind("focus.iButton",function(){h.addClass(a.classFocus)}).bind("blur.iButton",
function(){h.removeClass(a.classFocus)});c.isFunction(a.click)&&b.bind("click.iButton",function(){a.click.apply(i,[b[0].checked,b,a])});b.is(":disabled")&&this.disable(!0);c.browser.msie&&(h.find("*").andSelf().attr("unselectable","on"),b.bind("click.iButton",function(){b.triggerHandler("change.iButton")}));c.isFunction(a.init)&&a.init.apply(i,[b,a])},y={duration:200,easing:"swing",labelOn:"ON",labelOff:"OFF",enableDrag:!0,enableFx:!0,allowRadioUncheck:!1,clickOffset:120,className:"",classContainer:"ibutton-container",
classDisabled:"ibutton-disabled",classFocus:"ibutton-focus",classLabelOn:"ibutton-label-on",classLabelOff:"ibutton-label-off",classHandle:"ibutton-handle",classHandleInner:"ibutton-handle-inner",classHandleActive:"ibutton-active-handle",init:null,change:null,click:null,disable:null,destroy:null}})(jQuery);